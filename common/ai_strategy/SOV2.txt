# befriend
# conquer
# antagonize
# build_ship
# build_army
# unit_ratio
# build_building
# research_tech
# garrison
# protect
# influence

### A-is_historical
###
## SOV_dont_take_claims_on_POL_we_got_focus = {
##	enable = {
##		tag = SOV
##		country_exists = POL
##		has_completed_focus = SOV_claims_on_poland
##	}
##
##	abort = {
##		OR = {
##			NOT = { country_exists = POL }
##			has_completed_focus = SOV_demand_eastern_poland
##			date > 1941.01.01
##			has_war_with = POL
##		}
##	}
##
##	ai_strategy = {
##		type = ignore_claim
##		id = "POL"
##		value = 1
##	}
## }

try_to_befriend_finland = {
	enable = {
		tag = SOV
		has_completed_focus = SOV_baltic_security
		country_exists = FIN
		owns_state = 146
		NOT = { owns_state = 147 }
	}
	abort = {
		OR = {
			has_war_with = FIN
			owns_state = 147
		}
	}
	ai_strategy = {
		type = befriend
		id = "FIN"
		value = 50
	}
}



help_mao_SOV = {
	enable = {
		original_tag = SOV
		OR = {
			has_completed_focus = SOV_support_mao
			has_completed_focus = SOV_permanent_revolution
		}
		PRC = {
			has_government = communism
		}
		NOT = { has_completed_focus = SOV_reconcile_japan }
	}

	abort = {
		OR = {
			NOT = { has_government = communism }
			has_non_aggression_pact_with = JAP
			has_completed_focus = SOV_reconcile_japan
			has_completed_focus = SOV_operation_zet
			AND = {
				has_war_with = GER
				surrender_progress > 0.2
			}
		}
	}
	ai_strategy = {
		type = befriend
		id = "PRC"
		value = 100
	}
	ai_strategy = {
		type = befriend
		id = "SIK"
		value = 50
	}
	ai_strategy = {
		type = support
		id = "SIK"
		value = 50
	}
	ai_strategy = {
		type = support
		id = "PRC"
		value = 150
	}
}

china_struggles_against_jap_SOV = {
	enable = {
		original_tag = SOV
		OR = {
			has_completed_focus = SOV_anti_fascist_diplomacy
			has_completed_focus = SOV_internationalism
		}
		OR = {
			CHI = { has_war_with = JAP }
			PRC = { has_war_with = JAP }
		}
		NOT = {
			OR = {
				has_completed_focus = SOV_reconcile_japan
				has_completed_focus = SOV_support_mao
			}
		}

	}
	abort = {
		OR = {
			NOT = { CHI = { has_war_with = JAP } }
			NOT = { has_government = communism }
			has_non_aggression_pact_with = JAP
			has_completed_focus = SOV_reconcile_japan
			AND = {
				has_war_with = GER
				surrender_progress > 0.2
			}
			has_completed_focus = SOV_operation_zet
		}
	}
	ai_strategy = {
		type = antagonize
		id = "JAP"
		value = 100
	}
	ai_strategy = {
		type = support
		id = "CHI"
		value = 100
	}
	ai_strategy = {
		type = befriend
		id = "PRC"
		value = 50
	}
	ai_strategy = {
		type = support
		id = "PRC"
		value = 130
	}
}

china_after_ZET_focus = {
	enable = {
		original_tag = SOV
		has_completed_focus = SOV_operation_zet
		has_government = communism
		CHI = { has_war_with = JAP }
	}
	abort = {
		OR = {
			NOT = { CHI = { has_war_with = JAP } }
			NOT = { has_government = communism }
			has_non_aggression_pact_with = JAP
			AND = {
				has_war_with = GER
				surrender_progress > 0.1
			}
		}
	}
	ai_strategy = {
		type = antagonize
		id = "JAP"
		value = 100
	}
	ai_strategy = {
		type = befriend
		id = "CHI"
		value = 50
	}
	ai_strategy = {
		type = support
		id = "CHI"
		value = 130
	}
}

attack_japan_when_adolf_is_down = {
	enable = {
		tag = SOV
		has_completed_focus = SOV_war_with_japan
		country_exists = JAP
		JAP = { has_war_with = USA }
	}
	abort = {
		NOT = {
			country_exists = JAP
		}
	}
	ai_strategy = {
		type = antagonize
		id = "JAP"
		value = 300
	}
	ai_strategy = {
		type = befriend
		id = "USA"
		value = 100
	}
}

attack_man_sov = {
	enable = {
		tag = SOV
		country_exists = MAN
		has_wargoal_against = MAN
		MAN = {
			NOT = {
				OR = {
					is_in_faction = yes
					is_subject_of = JAP
				}

			}
		}
	}
	abort = {
		OR = {
			MAN = { is_subject_of = SOV }
			NOT = {	country_exists = MAN }
		}
	}
	ai_strategy = {
		type = antagonize
		id = "MAN"
		value = 200
	}
}

attack_china_sov = {
	enable = {
		tag = SOV
		has_completed_focus = SOV_attack_china
		country_exists = CHI
	}
	abort = {
		NOT = {
			country_exists = CHI
		}
	}
	ai_strategy = {
		type = antagonize
		id = "SIK"
		value = 200
	}
}

sov_build_a_lot_of_fighters = {
	enable = {
		original_tag = SOV
		surrender_progress < 0.8
	}
	abort = {
		surrender_progress > 0.8
	}
	ai_strategy = {
		type = air_factory_balance
		value = 25
	}
	ai_strategy = {
		type = equipment_production_factor
		id = fighter
		value = 50
	}
	ai_strategy = {
		type = equipment_production_factor
		id = cas
		value = 20 ## was -30
	}
	ai_strategy = {
		type = equipment_variant_production_factor
		id = heavy_fighter_equipment
		value = -90
	}
	ai_strategy = {
		type = equipment_production_factor
		id = naval_bomber
		value = -80
	}
	ai_strategy = {
		type = equipment_production_factor
		id = tactical_bomber
		value = 10 ## was 20
	}
}

sov_new_aircraft_upgrade = {  ##not too early
	enable = {
		original_tag = SOV
		OR = {
			has_tech = fighter2
			has_tech = CAS2
		}
		OR = {
			date > 1942.01.01
			has_war = yes
		}
	}
	abort = {
		AND = {
			has_tech = fighter2
			has_tech = CAS2
		}
		OR = {
			has_tech = fighter3
			has_tech = CAS3
		}
	}
	ai_strategy = {
		type = production_upgrade_desire_offset
		id = fighter_equipment_2
		value = 500
	}
	ai_strategy = {
		type = production_upgrade_desire_offset
		id = CAS_equipment_2
		value = 500
	}
}

sov_always_need_ammo = {
	enable = {
		original_tag = SOV
		has_war_with = GER
		surrender_progress > 0.2
	}
	abort = {
		OR = {
			has_war = no
			has_capitulated = yes
			surrender_progress < 0.0
		}
	}
	ai_strategy = {
		type = equipment_production_factor
		id = infantry
		value = 20
	}
	ai_strategy = {
		type = equipment_production_factor
		id = fighter
		value = 20
	}
	ai_strategy = {
		type = equipment_production_factor
		id = armor
		value = -10
	}
}
increase_that_air_count = {
	enable = {
		original_tag = SOV
		has_war = yes
		date > 1942.06.01
		surrender_progress < 0.4
		num_of_military_factories > 170
		has_deployed_air_force_size = {
			type = fighter
			size < 2500
		}
	}
	abort = {
		OR = {
			has_war = no
			has_capitulated = yes
			has_deployed_air_force_size = {
					type = fighter
					size > 3500
			}
			num_of_military_factories < 120
		}
	}
	ai_strategy = {
		type = air_factory_balance
		value = 40
	}
	ai_strategy = {
		type = equipment_production_factor
		id = fighter
		value = 120
	}
	ai_strategy = {
		type = equipment_variant_production_factor
		id = heavy_fighter_equipment
		value = -60	#up from -80 8.9
	}
	ai_strategy = {
		type = equipment_production_factor
		id = cas
		value = 30
	}
	ai_strategy = {
		type = equipment_production_factor
		id = naval_bomber
		value = -200
	}
	ai_strategy = {
		type = equipment_production_factor
		id = strategic_bomber
		value = -200
	}
	ai_strategy = {
		type = equipment_production_factor
		id = tactical_bomber
		value = -50
	}
}

SOV_no_plane_build_AA = {
	enable = {
		original_tag = SOV
		has_war = yes
		has_deployed_air_force_size = {
			type = fighter
			size < 300
		}
		surrender_progress > 0.7
	}
	abort = {
		OR = {
			AND = {
				date > 1942.06.01
				surrender_progress < 0.4
				num_of_military_factories > 150
			}
			has_war = no
			AND = {
				has_war = yes
				has_deployed_air_force_size = {
						type = fighter
						size > 1000
				}
			}
		}
	}
	ai_strategy = {
		type = air_factory_balance
		value = -80
	}
	ai_strategy = {
		type = equipment_production_factor
		id = anti_air
		value = 100
	}
	ai_strategy = {
		type = equipment_production_factor
		id = fighter
		value = -75
	}
	ai_strategy = {
		type = equipment_production_factor
		id = cas
		value = -100
	}
	ai_strategy = {
		type = equipment_production_factor
		id = naval_bomber
		value = -200
	}
	ai_strategy = {
		type = equipment_production_factor
		id = strategic_bomber
		value = -200
	}
	ai_strategy = {
		type = equipment_production_factor
		id = tactical_bomber
		value = -200
	}
}

build_civs_not_mils_comrade = {
	enable = {
		tag = SOV
		date < 1938.01.01
		has_war = no
	}
	abort_when_not_enabled = yes
	ai_strategy = {
		type = building_target
		id = industrial_complex
		value = 90
	}
}
build_civs_not_mils_1939 = {
	enable = {
		tag = SOV
		has_start_date > 1939.01.01
		NOT = {
			OR = {
				has_war_with = GER
				has_war_with = JAP
				has_war_with = ENG
				has_war_with = POL
			}
		}
	}
	abort_when_not_enabled = yes
	ai_strategy = {
		type = building_target
		id = industrial_complex
		value = 110
	}
}

## still_build_more_civ = {
##	enable = {
##		tag = SOV
##		date < 1940.01.01
##	}
##	abort = {
##		OR = {
##			has_war = yes
##			date > 1940.01.01
##			OR = {
##				date > 1939.06.01
##				NOT = { has_global_flag = sov_yes_pact }
##			}
##			threat > 0.7
##		}
##	}
##	ai_strategy = {
##		type = added_military_to_civilian_factory_ratio
##		value = -50
##	}
## }

SOV_start_building_MIL = {   # come se non ci fosse un domani...
	enable = {
		tag = SOV
		date > 1939.6.1
	}
	ai_strategy = {
		type = added_military_to_civilian_factory_ratio
		value = 50
	}
}

## now_build_your_mils_sov = {
##	enable = {
##		tag = SOV
##		date > 1941.1.1
##		has_war = yes
##	}
##	abort = {
##		NOT = {
##			has_war = yes
##		}
##	}
##	ai_strategy = {
##		type = added_military_to_civilian_factory_ratio
##		value = 60
##	}
## }

dockyards_useless_now = {
	enable = {
		tag = SOV
		has_war_with = GER
	}
	abort = {
		NOT = {
			has_war_with = GER
		}
	}
	ai_strategy = {
		type = dockyard_to_military_factory_ratio
		value = -250
	}
}


time_to_leave_light_tanks = {
	enable = {
		tag = SOV
		date > 1941.1.1
		has_tech = improved_medium_tank
		has_template_ai_majority_unit = medium_armor
	}
	abort = {
		has_tech = main_battle_tank
	}
	ai_strategy = {
		type = equipment_variant_production_factor
		id = light_tank_equipment
		value = -60
	}
	ai_strategy = {
		type = equipment_variant_production_factor
		id = medium_tank_equipment
		value = 60
	}

}

sov_higher_armor_tank_production = {
	enable = {
		tag = SOV
		date > 1941.1.1
		has_tech = improved_medium_tank
		has_template_ai_majority_unit = medium_armor
	}
	abort = {
		OR = {
			has_tech = main_battle_tank
			AND = {
				has_war = yes
				surrender_progress > 0.5
			}
		}
	}
	ai_strategy = {
		type = equipment_variant_production_factor
		id = motorized_equipment
		value = 25
	}
	ai_strategy = {
		type = equipment_production_factor
		id = armor
		value = 10
	}
	ai_strategy = {
		type = role_ratio
		id = armor
		value = 15
	}
}

sov_historical_expand_navy = {
	enable = {
		tag = SOV
		#is_historical_focus_on = yes
		has_completed_focus = SOV_ocean_going_navy
		date < 1941.01.01
		has_war = no
	}
	abort = {
		OR = {
			has_war = yes
			date > 1942.01.01
		}
	}
	ai_strategy = {
		type = building_target
		id = dockyard
		value = 10
	}

}


sov_warning_fin_is_up_to_something = {
	enable = {
		tag = SOV
		FIN = { has_idea = FIN_German_support }
		has_war_with = GER
	}
	abort = {
		OR = {
			has_war_with = FIN
			AND = {
				NOT = { FIN = { has_idea = FIN_German_support } }
				NOT = { FIN = { has_idea = FIN_German_advisors } }
				NOT = { FIN = { has_idea = FIN_strengthen_fascists } }
			}
			date > 1944.01.01
		}
	}
	ai_strategy = {
		type = prepare_for_war
		id = "FIN"
		value = 100
	}
}

Support_commie_france_strategy = {
	enable = {
		tag = SOV
		has_completed_focus = SOV_support_left_france
	}
	abort = {
		OR = {
			has_war_with = FRA
			FRA = { is_in_faction_with = ENG }
		}
	}
	ai_strategy = {
		type = befriend
		id = "FRA"
		value = 50
	}
	ai_strategy = {
		type = alliance
		id = "FRA"
		value = 75
	}
}

Baltic_communism_strategy = {
	enable = {
		tag = SOV
		has_completed_focus = SOV_baltic_communism
	}
	abort = {
		OR = {
			has_war_with = EST
			has_war_with = LIT
			has_war_with = LAT
			has_completed_focus = SOV_claims_on_baltic
		}
	}
	ai_strategy = {
		type = befriend
		id = "EST"
		value = 50
	}
	ai_strategy = {
		type = alliance
		id = "EST"
		value = 50
	}
	ai_strategy = {
		type = befriend
		id = "LIT"
		value = 50
	}
	ai_strategy = {
		type = alliance
		id = "LIT"
		value = 50
	}
	ai_strategy = {
		type = befriend
		id = "LAT"
		value = 50
	}
	ai_strategy = {
		type = alliance
		id = "LAT"
		value = 50
	}
}

SOV_Support_czechs = {
	enable = {
		tag = SOV
		has_completed_focus = SOV_support_left_czechoslovakia
		CZE = { has_war = yes }
		OR = {
			GER = {
				has_government = fascism
				has_war = yes
			}
			JAP = {
				has_government = fascism
				has_war = yes
			}
			HUN = {
				has_government = fascism
				has_war = yes
			}
		}
	}
	abort = {
		has_war = yes
		surrender_progress > 0.1
	}

	ai_strategy = {
		type = befriend
		id = "CZE"
		value = 50
	}
	ai_strategy = {
		type = support
		id = "CZE"
		value = 50
	}
	ai_strategy = {
		type = send_volunteers_desire
		id = "CZE"
		value = 75
	}
}

SOV_baltic_allies = { #used to prevent baltic countries from joining PRC
	enable = {
		OR = {
			tag = EST
			tag = LAT
			tag = LIT
		}
		is_in_faction = no
		SOV = { has_completed_focus = SOV_baltic_communism }
	}
	abort = {
		has_war_with = SOV
	}
	ai_strategy = {
		type = alliance
		id = "PRC"
		value = -500
	}
}


sov_expand_rubber_production = {
	enable = {
		tag = SOV
		has_completed_focus = SOV_Rubber_Industry
		OR = {
			JAP = { has_war_with = ENG }
			has_war_with = ENG
		}
	}
	abort = {
		has_war = yes
		surrender_progress > 0.5
	}
	ai_strategy = {
		type = building_target
		id = synthetic_refinery
		value = 6
	}

}

sov_dont_be_dumbass_and_dow_germany = {
	enable = {
		tag = SOV
		has_completed_focus = SOV_war_with_germany
		has_wargoal_against = GER
		OR = {
			AND = {
				has_war_with = POL
				POL = { has_capitulated = no }
			}
			NOT = {
				is_neighbor_of = GER
			}
			surrender_progress > 0.1
		}
	}
	abort = {
		OR = {
			has_war_with = GER
			has_war = no
			NOT = { has_wargoal_against = GER }
			GER = {
				has_war = yes
				surrender_progress > 0.2
			}
			AND = {
				arms_factory > 200
				has_deployed_air_force_size = {
					size > 3500
					type = fighter
				}
				manpower_per_military_factory > 7500
				surrender_progress < 0.01
			}
		}
	}
	ai_strategy = {
		type = declare_war
		id = "GER"
		value = -2000
	}
	ai_strategy = {
		type = ignore
		id = "GER"
		value = 100
	}

}
